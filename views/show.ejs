<%- include('./partials/header')%>
<body>
    <%- include('./partials/preloader')%>
    <%- include('./partials/flasher')%>
    <%- include('./partials/navbar')%>

    <div class = "container">
        <div id="map"></div>

    </div>


    <div class = "container mt-4 mycontainer1">
        
        
        <div class="row">
            <div class="col-6">
                <div id="foodpostCarousel" class="carousel slide" data-ride="carousel">
                    <div class="carousel-inner">
                        <% if(!singleFoodPost.images.length){ %>    
                            <div class="carousel-item active">
                                <img src="/photos/defaultImage.jpg" class="d-block w-100" alt="...">
                            </div>
                        <% }else{ %>
                            <% for (var x = 0; x< singleFoodPost.images.length ; x++){ %>
                                <% if(x==0){ %>
                                    <div class="carousel-item active">
                                        <img src="<%= singleFoodPost.images[x].url %>" class="d-block w-100" alt="...">
                                    </div>
                                <% }else{ %>
                                    <div class="carousel-item">
                                        <img src="<%= singleFoodPost.images[x].url %>" class="d-block w-100" alt="...">
                                    </div>
                                <%}%>
                            <%} %>
                        <% }%>
                        

                    </div>
                    <% if(singleFoodPost.images.length > 1) {%>
                    <a class="carousel-control-prev" href="#foodpostCarousel" role="button" data-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="sr-only">Previous</span>
                    </a>
                    <a class="carousel-control-next" href="#foodpostCarousel" role="button" data-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="sr-only">Next</span>
                    </a>
                    <% } %>
                </div>
            </div>
            <div class="col-6">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title"><%= singleFoodPost.name %></h5>
                        <ul class="list-group list-group-flush">
                        <li class="list-group-item"><i class='bx bx-user mr-2' ></i><a href="/profile/<%= singleFoodPost.writer._id %>"><%= singleFoodPost.writer.username %></a></li>
                        <li class="list-group-item"><i class='bx bx-pin mr-2' ></i><%= singleFoodPost.location %></li>
                        </ul>
                        <br>
                        <p class="card-text ml-3"><%= singleFoodPost.description %></p>
                        <% if (singleFoodPost.writer){ %>
                        <%  if( currentUser && singleFoodPost.writer.equals(currentUser._id))  {%>
                            <div class="card-body" id = "editDelete">
                                <div class="input-field">
                                    <a href="/foodposts/<%=singleFoodPost._id%>/edit" class="btn" id = "mybutton2">Edit foodpost</a>
                                </div>
                                <form class="d-inline" action="/foodposts/<%=singleFoodPost._id%>?_method=DELETE" method="POST">
                                    <div class="input-field">
                                        <input type="submit" class="submit ml-3" value="Delete Post" id="firstButton">
                                    </div>
                                </form>

                            </div>
                        <% } %>
                    <% } %>
                    </div>
                </div>
            </div>
        </div>
        
        
    </div>
    
    
    <!-- ======================================================================================================================================== -->
    <script>
        const MapBoxToken = "<%- process.env.MAPBOX_API_TOKEN %>"
        const destination = [<%= singleFoodPost.geometry.coordinates[0] %>,<%= singleFoodPost.geometry.coordinates[1] %>]
    </script>
    <script src="/jsfiles/showMapbox.js"></script>
    <link rel="stylesheet" href="/cssfiles/show.css">

    <!-- ======================================================================================================================================== -->

    
    

<%- include('./partials/footer')%>
